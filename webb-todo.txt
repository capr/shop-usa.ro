socket API
------------------------------------------------------------------------------
connect(), accept(), read(), write(), select()


thread API
------------------------------------------------------------------------------
newthread, current, suspend, resume


socketloop API
------------------------------------------------------------------------------
connect(), accept(), read(), write(), close()
newserver(host, port, handler, accept)


https API
------------------------------------------------------------------------------
wrap(socket) -> https_socket


http API
------------------------------------------------------------------------------
request: secure, method, uri, path, args, query, params, headers, getbody, postvars
reply:   status, headers, body, chunk, buffer, compress, check_etag, maxage, close


http features
------------------------------------------------------------------------------
- chunked mode -> compress -> send chunks -> send trailer headers
- buffered mode -> compress -> send content-length -> send data


stream API
------------------------------------------------------------------------------
read([seek[, bytes]]) --random or sequential read
write(bytes) --sequential write
trailers(t)


non-blocking upstream APIs
------------------------------------------------------------------------------
newthread(); getpage(url), query(), etc.


stream API
------------------------------------------------------------------------------
getfile(path|stream)
sendfile(path|stream)
	- on-the-fly compression
		- cache compressed files to disk
	- serve byte ranges (for pdfs)
	- send etag, check if-none-match and return 304-not-modified
		- note: make a diff. etag for each entity variant
	- send max-age based on probability of modif. frequency
	- for files, make an etag based on the file's mtime


template API
------------------------------------------------------------------------------
luapage(string|file)



action API
------------------------------------------------------------------------------



- missing jpg in img/p redirects to default jpg
- missing css, js, png, jpg, gif returns text/plain 404
- anything else goes to lua
    - a_<action>.html is a Lua action template
	- clean up lp.lua
    - a_<action>.lua is a Lua action module
    - missing action redirects to /

